<!DOCTYPE html><html lang="es" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Historial de Pagos - CBTA 71 | CBTA 71</title><link rel="icon" href="/Logo.png" type="image/png"><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_astro/Dashboard.DR7WEF1-.css">
<style>:root{--cbta-green: #2E594D}.page-link{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;border-radius:.75rem;border:1px solid #f3f4f6;color:#9ca3af;transition:all .2s;background:#fff;cursor:pointer;font-weight:700}.page-link.active{background-color:#2e594d;color:#fff;border-color:#2e594d}.filter-card{position:absolute;top:100%;right:0;margin-top:.5rem;width:18rem;background:#fff;border-radius:1rem;box-shadow:0 20px 25px -5px #0000001a;border:1px solid #f3f4f6;padding:1.25rem;z-index:50;display:none}.filter-card.show{display:block}
body{font-family:Inter,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background:var(--BACKGROUND_COLOR);color:var(--TEXT_COLOR_DARK)}.sidebar-closed[data-astro-cid-sckkx6r4]{transform:translate(-100%)}.transition-transform-fast[data-astro-cid-sckkx6r4]{transition:transform .3s cubic-bezier(.25,.46,.45,.94)}#sidebar-menu[data-astro-cid-sckkx6r4]{scrollbar-width:none}#sidebar-menu[data-astro-cid-sckkx6r4]::-webkit-scrollbar{width:0;height:0}.content-fade-in[data-astro-cid-sckkx6r4]{animation:fadeIn .8s cubic-bezier(.19,1,.22,1)}@keyframes fadeIn{0%{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}.nav-active[data-astro-cid-sckkx6r4]{background-color:#fff;color:var(--PRIMARY_COLOR);font-weight:700;box-shadow:0 4px 12px #00000026;border-left:5px solid var(--ACCENT_COLOR);padding-left:1rem}.nav-inactive[data-astro-cid-sckkx6r4]:hover{background-color:#fff3;color:#fff}
</style><script type="module" src="/_astro/page.CZQmTZnr.js"></script></head> <body class="flex min-h-screen antialiased" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <nav id="sidebar-menu" class="bg-[#2e594d] text-white flex-col p-5 shadow-2xl z-50 overflow-y-auto
		fixed inset-0 w-full max-w-[250px] h-full transition-transform-fast sidebar-closed
		md:fixed md:top-0 md:flex md:h-screen md:w-[250px] md:shadow-lg md:rounded-r-xl" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;">  <button id="close-sidebar-button" class="md:hidden absolute top-3 right-3 p-2 rounded-full bg-white/20 hover:bg-white/40 z-50 transition text-white" aria-label="Cerrar menú lateral" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M18 6l-12 12" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M6 6l12 12" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg> </button>  <div class="flex items-center gap-4 mb-10 pt-3 border-b border-white/10 pb-4" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <div class="h-10 w-10" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <img src="/Logo.png" alt="Logo CBTA 71" class="w-full h-full object-contain" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> </div> <div data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <h1 class="text-xl font-extrabold tracking-wide" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;">CBTA 71</h1> <p class="text-xs opacity-80" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;">Sistema Administrativo</p> </div> </div>  <div class="flex-grow overflow-y-auto pr-2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <ul id="main-navigation" class="space-y-2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;">  <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/Dashboard" data-path="/Dashboard" class="nav-link nav-inactive flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M3 3v18h18" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M18 17v-4" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M12 17v-8" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M6 17v-2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Dashboard
</a> </li>  <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/concepts" data-path="/concepts" class="nav-link nav-inactive flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M13.5 6.5l4 4" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M19 16v3h-3" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Conceptos
</a> </li>  <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/students" data-path="/students" class="nav-link nav-inactive flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M16 3.125a4 4 0 1 1 0 7.75" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M21 21v-2a4 4 0 0 0 -3 -3.85" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Estudiantes
</a> </li>  <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/payments" data-path="/payments" class="nav-link nav-inactive flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M9 14h-2a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M12 17v-1h-3a1 1 0 0 0 -1 1v2a1 1 0 0 0 1 1h3v1" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Pagos
</a> </li>  <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/debts" data-path="/debts" class="nav-link nav-inactive flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M14 3v4a1 1 0 0 0 1 1h4" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M10 12l4 4m0 -4l-4 4" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Adeudos
</a> </li>  <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/roles" data-path="/roles" class="nav-link nav-inactive flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M12 10a2 2 0 0 1 2 2a2 2 0 0 1 2 2a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2 -2a2 2 0 0 1 2 -2a2 2 0 0 1 2 -2z" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Roles y Usuarios
</a> </li> </ul> </div>  <div class="mt-auto pt-4 border-t border-white/10" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <ul class="space-y-2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <li data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <a href="/logout" class="flex items-center gap-4 py-3 px-4 rounded-lg text-white hover:bg-white/10 transition-colors duration-200" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M7 12h14l-3 -3m0 6l3 -3" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg>
Salir
</a> </li> </ul> </div> </nav>  <main class="flex-1 p-4 md:p-8 overflow-y-auto md:ml-[250px] relative" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;">  <button id="open-sidebar-button" class="md:hidden fixed top-4 left-4 p-3 rounded-xl bg-[${PRIMARY_COLOR}] text-white shadow-xl z-40 transition hover:bg-[#256d5e]" aria-label="Abrir menú lateral" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"><path stroke="none" d="M0 0h24v24H0z" fill="none" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M4 6l16 0" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M4 12l16 0" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path><path d="M4 18l16 0" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></path></svg> </button> <div class="h-16 md:hidden" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;"></div>  <div class="bg-white p-6 md:p-8 rounded-xl shadow-2xl content-fade-in min-h-[calc(100vh-4rem)]" data-astro-cid-sckkx6r4 style="--PRIMARY_COLOR: #2e594d;--ACCENT_COLOR: #86efad;--BACKGROUND_COLOR: #d9dde2;--TEXT_COLOR_DARK: #374151;">   <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" crossorigin="anonymous" defer></script> <div class="max-w-7xl mx-auto px-6 py-10 bg-white min-h-screen"> <div class="flex items-center gap-5 mb-8"> <div class="w-16 h-16 bg-[#eaf1ef] rounded-2xl flex items-center justify-center border-2 border-[#2E594D] shrink-0"> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#2E594D" stroke-width="2.5"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg> </div> <div> <h1 class="text-3xl font-black text-gray-800 tracking-tight leading-none">Historial de Pagos Realizados</h1> <p class="text-gray-500 font-medium mt-1">Panel de control y auditoría financiera</p> </div> </div> <div class="flex flex-row items-center gap-3 mb-8 w-full"> <div class="relative flex-grow"> <input type="text" id="search-input" placeholder="Buscar por nombre, matrícula o concepto..." class="w-full pl-12 pr-4 h-[46px] bg-gray-50 border border-gray-200 rounded-xl text-sm text-gray-700 focus:ring-2 focus:ring-[#2E594D] focus:bg-white outline-none transition-all shadow-sm"> <svg class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> </div> <div class="flex items-center gap-2 relative"> <button id="toggle-filters" class="flex items-center gap-2 px-5 h-[46px] border-2 border-[#2E594D] text-[#2E594D] font-bold text-sm rounded-xl hover:bg-[#2E594D] hover:text-white transition-all shadow-sm"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>
Filtros
</button> <button id="export-xlsx" class="flex items-center gap-2 px-5 h-[46px] bg-emerald-700 text-white font-bold text-sm rounded-xl hover:bg-emerald-800 transition-all shadow-lg active:scale-95"> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
EXPORTAR REPORTE
</button> <div id="filter-menu" class="filter-card"> <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">Opciones de Filtrado</h3> <div class="space-y-4"> <div> <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Semestre:</label> <select id="semester-filter" class="w-full mt-1 p-2 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-[#2E594D]"> <option value="all">Todos</option> <option value="1">1º Semestre</option><option value="2">2º Semestre</option><option value="3">3º Semestre</option><option value="4">4º Semestre</option><option value="5">5º Semestre</option><option value="6">6º Semestre</option><option value="7">7º Semestre</option><option value="8">8º Semestre</option><option value="9">9º Semestre</option><option value="10">10º Semestre</option> </select> </div> <div> <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Método:</label> <select id="method-filter" class="w-full mt-1 p-2 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-[#2E594D]"> <option value="all">Todos</option> <option value="Efectivo">Efectivo</option> <option value="Transferencia">Transferencia</option> <option value="Depósito">Depósito</option> </select> </div> <button id="clear-filters" class="w-full mt-2 p-2 bg-red-50 text-red-500 rounded-lg text-sm font-bold hover:bg-red-100 transition-colors">Limpiar Filtros</button> </div> </div> </div> </div> <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden mb-8"> <div class="overflow-x-auto"> <table class="w-full border-collapse"> <thead> <tr class="bg-[#2E594D] text-white"> <th class="px-6 py-5 text-left text-xs font-black uppercase tracking-widest">Fecha</th> <th class="px-6 py-5 text-left text-xs font-black uppercase tracking-widest">Concepto de Pago</th> <th class="px-6 py-5 text-left text-xs font-black uppercase tracking-widest">Estudiante</th> <th class="px-6 py-5 text-left text-xs font-black uppercase tracking-widest">Método</th> <th class="px-6 py-5 text-right text-xs font-black uppercase tracking-widest">Monto</th> </tr> </thead> <tbody id="payments-table-body" class="divide-y divide-gray-50"></tbody> </table> </div> </div> <div class="flex flex-col items-center gap-4 py-4"> <p class="text-slate-500 text-sm font-medium">Registros: <span id="p-total" class="font-bold text-slate-800">0</span></p> <div class="flex items-center gap-2" id="pagination-controls"></div> </div> </div> <script>(function(){const studentsJSON = "[]";
const careerMapJSON = "{\"TAG-E\":\"Técnico Agropecuario\",\"TOF\":\"Técnico en Ofimática\",\"TEM\":\"Técnico en Admón. de Emprendimiento\",\"TAG-M\":\"Técnico Agropecuario (Mixta)\",\"TRH\":\"Técnico en Admón. de Recursos Humanos (Mixta)\",\"\":\"Sin Carrera\"}";

window.__INITIAL_STUDENTS_PAYMENTS = JSON.parse(studentsJSON);
window.__CAREER_MAP = JSON.parse(careerMapJSON);
})();</script> <script type="module">
(function() {
    let currentPage = 1;
    const itemsPerPage = 50;
    let filteredData = [];

    const tableBody = document.getElementById('payments-table-body');
    const searchInput = document.getElementById('search-input');
    const filterMenu = document.getElementById('filter-menu');
    const btnExport = document.getElementById('export-xlsx');

    document.getElementById('toggle-filters').onclick = (e) => { e.stopPropagation(); filterMenu.classList.toggle('show'); };
    document.onclick = () => filterMenu.classList.remove('show');
    filterMenu.onclick = (e) => e.stopPropagation();

    const render = () => {
        const students = JSON.parse(localStorage.getItem('studentsList') || '[]') || window.__INITIAL_STUDENTS_PAYMENTS;
        const allCharges = JSON.parse(localStorage.getItem('chargesList') || '[]').filter(c => 
            ['paid', 'pagado'].includes(String(c.status || '').toLowerCase())
        );

        const term = searchInput.value.toLowerCase();
        const semesterSel = document.getElementById('semester-filter').value;
        const methodSel = document.getElementById('method-filter').value;

        filteredData = allCharges.filter(p => {
            const s = students.find(x => String(x.id) === String(p.studentId) || String(x.numControl) === String(p.studentId));
            if(!s) return false;
            
            const conceptoReal = p.conceptTitle || p.conceptName || p.conceptText || p.concept || p.title || 'PAGO GENERAL';
            const fullName = `${s.nombre} ${s.apellidoP} ${s.apellidoM}`.toLowerCase();
            
            const matchesSearch = fullName.includes(term) || String(s.numControl).includes(term) || conceptoReal.toLowerCase().includes(term);
            const matchesSemester = semesterSel === 'all' || String(s.semestre) === semesterSel;
            const matchesMethod = methodSel === 'all' || p.paymentMethod === methodSel;
            
            return matchesSearch && matchesSemester && matchesMethod;
        });

        const startIdx = (currentPage - 1) * itemsPerPage;
        const pageItems = filteredData.slice(startIdx, startIdx + itemsPerPage);

        tableBody.innerHTML = pageItems.map(p => {
            const s = students.find(x => String(x.id) === String(p.studentId) || String(x.numControl) === String(p.studentId));
            const displayConcept = p.conceptTitle || p.conceptName || p.conceptText || p.concept || p.title || 'PAGO REGISTRADO';

            return `
                <tr class="hover:bg-gray-50/50 transition-colors">
                    <td class="px-6 py-5 text-gray-500 font-mono text-xs">${new Date(p.paidAt || p.date).toLocaleDateString('es-MX')}</td>
                    <td class="px-6 py-5">
                        <span class="text-gray-900 font-extrabold text-xs uppercase block" style="letter-spacing: -0.01em;">
                            ${displayConcept}
                        </span>
                    </td>
                    <td class="px-6 py-5">
                        <div class="flex flex-col">
                            <span class="text-gray-800 font-bold text-xs uppercase leading-tight">${s.nombre} ${s.apellidoP} ${s.apellidoM}</span>
                            <span class="text-[9px] text-gray-400 font-mono">${s.numControl}</span>
                        </div>
                    </td>
                    <td class="px-6 py-5 text-[10px] font-bold text-gray-400 uppercase">${p.paymentMethod || 'EFECTIVO'}</td>
                    <td class="px-6 py-5 text-right font-black text-[#2E594D] text-sm">
                        $${Number(p.amount).toLocaleString('es-MX', {minimumFractionDigits:2})}
                    </td>
                </tr>
            `;
        }).join('');

        document.getElementById('p-total').textContent = filteredData.length;
        renderPagination(Math.ceil(filteredData.length / itemsPerPage));
    };

    const renderPagination = (totalPages) => {
        const controls = document.getElementById('pagination-controls');
        if(totalPages <= 1) { controls.innerHTML = ''; return; }
        let html = '';
        for(let i=1; i<=totalPages; i++) {
            html += `<button class="page-link ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
        }
        controls.innerHTML = html;
        controls.querySelectorAll('button').forEach(b => {
            b.onclick = () => { currentPage = parseInt(b.dataset.page); render(); };
        });
    };

    // --- NUEVA LÓGICA DE EXPORTACIÓN POR CARRERAS ---
    btnExport.onclick = () => {
        if(filteredData.length === 0) return alert("No hay datos para exportar");
        
        const students = JSON.parse(localStorage.getItem('studentsList') || '[]') || window.__INITIAL_STUDENTS_PAYMENTS;
        const CAREER_MAP = window.__CAREER_MAP;
        const wb = XLSX.utils.book_new();

        // 1. Identificar las carreras únicas presentes en los resultados filtrados
        const uniqueCareers = [...new Set(filteredData.map(p => {
            const s = students.find(x => String(x.id) === String(p.studentId) || String(x.numControl) === String(p.studentId));
            return s ? s.carrera : '';
        }))];

        // 2. Crear una pestaña por cada carrera
        uniqueCareers.forEach(careerCode => {
            const paymentsInCareer = filteredData.filter(p => {
                const s = students.find(x => String(x.id) === String(p.studentId) || String(x.numControl) === String(p.studentId));
                return s && s.carrera === careerCode;
            });

            // Ordenar por semestre y luego por nombre
            const sortedPayments = paymentsInCareer.sort((a, b) => {
                const sA = students.find(x => String(x.id) === String(a.studentId) || String(x.numControl) === String(a.studentId));
                const sB = students.find(x => String(x.id) === String(b.studentId) || String(x.numControl) === String(b.studentId));
                return (sA.semestre - sB.semestre) || `${sA.nombre}`.localeCompare(`${sB.nombre}`);
            });

            const exportData = sortedPayments.map(p => {
                const s = students.find(x => String(x.id) === String(p.studentId) || String(x.numControl) === String(p.studentId));
                return {
                    'Fecha': new Date(p.paidAt || p.date).toLocaleDateString('es-MX'),
                    'Semestre': s.semestre + 'º',
                    'Matrícula': s.numControl,
                    'Estudiante': `${s.nombre} ${s.apellidoP} ${s.apellidoM}`,
                    'Concepto': p.conceptTitle || p.conceptName || p.concept || p.title || 'PAGO',
                    'Método': p.paymentMethod || 'Efectivo',
                    'Monto ($)': Number(p.amount)
                };
            });

            if (exportData.length > 0) {
                const ws = XLSX.utils.json_to_sheet(exportData);
                
                // Nombre de la hoja limpio y corto (Máx 31 caracteres para Excel)
                let sheetName = (CAREER_MAP[careerCode] || careerCode || 'General')
                    .replace(/[\\*?:/\[\]]/g, '')
                    .substring(0, 31);
                
                XLSX.utils.book_append_sheet(wb, ws, sheetName);
            }
        });

        XLSX.writeFile(wb, `Reporte_Pagos_CBTA71_${new Date().toLocaleDateString().replace(/\//g, '-')}.xlsx`);
    };

    searchInput.oninput = () => { currentPage = 1; render(); };
    document.getElementById('semester-filter').onchange = () => { currentPage = 1; render(); };
    document.getElementById('method-filter').onchange = () => { currentPage = 1; render(); };
    document.getElementById('clear-filters').onclick = () => { 
        searchInput.value = ''; 
        document.getElementById('semester-filter').value = 'all'; 
        document.getElementById('method-filter').value = 'all'; 
        render(); 
    };

    render();
})();
</script>  </div> </main> <script>
		const sidebar = document.getElementById('sidebar-menu');
		const openButton = document.getElementById('open-sidebar-button');
		const closeButton = document.getElementById('close-sidebar-button');
		const navLinks = document.querySelectorAll('.nav-link');
		const activeClass = 'nav-active';
		const inactiveClass = 'nav-inactive';


		function setActiveLink() {
			// Normaliza la ruta actual: / o /Dashboard
			let currentPath = window.location.pathname.replace(/\/$/, "");
			if (currentPath === "") currentPath = "/Dashboard";
			
			navLinks.forEach(link => {
				const linkPath = link.getAttribute('data-path');
				
				link.classList.remove(activeClass, inactiveClass);


				if (linkPath === currentPath) {
					link.classList.add(activeClass);
				} else {
					link.classList.add(inactiveClass);
				}
			});
		}


		function openSidebar() {
			sidebar.classList.remove('sidebar-closed', 'hidden');
			openButton.style.display = 'none';
			document.body.style.overflow = 'hidden';
			if (window.innerWidth < 768) {
				sidebar.classList.remove('hidden');
				sidebar.classList.add('fixed', 'inset-0');
			}
		}

		function closeSidebar() {
			sidebar.classList.add('sidebar-closed');
			// Usamos setTimeout solo para acciones después de la transición
			setTimeout(() => {
				if (window.innerWidth < 768) {
					sidebar.classList.add('hidden');
					sidebar.classList.remove('fixed', 'inset-0');
					openButton.style.display = 'block';
				}
				document.body.style.overflow = '';
			}, 300); // 300ms = duración de la transición CSS
		}


		openButton?.addEventListener('click', openSidebar);
		closeButton?.addEventListener('click', closeSidebar);
		
		// Cerrar sidebar en móvil al hacer click en un enlace
		navLinks.forEach(link => link.addEventListener('click', (e) => {
			if (window.innerWidth < 768) closeSidebar();
			// No llamar setActiveLink aquí, sino dejar que Astro lo maneje o window.load
		}));


		const handleResize = () => {
			if (window.innerWidth >= 768) {
				// Desktop: Sidebar siempre visible y abierto
				sidebar.classList.remove('hidden', 'sidebar-closed', 'inset-0');
				openButton.style.display = 'none';
				document.body.style.overflow = '';
			} else {
				// Mobile: Ocultar si está cerrado
				if (sidebar.classList.contains('sidebar-closed')) {
                    sidebar.classList.add('hidden');
                    openButton.style.display = 'block';
                } else {
                    openButton.style.display = 'none';
                }
			}
		};


		window.addEventListener('resize', handleResize);
		window.addEventListener('load', () => { handleResize(); setActiveLink(); });
		document.addEventListener("astro:after-swap", setActiveLink);
	</script> </body> </html>